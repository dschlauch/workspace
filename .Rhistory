lapply(plotList, function(x){x$auc.methodPred})
c(lapply(plotList, function(x){x$auc.methodPred}))
c(lapply(plotList, function(x){x$auc.methodPred}))
unlist(lapply(plotList, function(x){x$auc.methodPred}))
rank(unlist(lapply(plotList, function(x){x$auc.methodPred})))
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
rank(unlist(lapply(plotList, function(x){x$auc.methodPred})))
scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))
scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1:5]
p.value <- pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
p.value
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
p.value
legend(.5,.6, c("Control to COPD", "Randomized Phenotype"), lty=c(2,2),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
lines(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
1
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
legend(.5,.2, c("Control to COPD", "Randomized Phenotype"), lty=c(1,1),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/COPDGene_combined_runs/activeImage.RData")
meltTM <- melt(abs(transMatrices[[3]]))
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
mergedTM <- merge(meltTM, ppi, by=c("Var1","Var2"), all.x=T)
mergedTM[is.na(mergedTM)] <- 0
mergedTM <- mergedTM[as.character(mergedTM[,1])!=as.character(mergedTM[,2]),]
plotList <- lapply(1:401, function(x){
meltTM <- melt(abs(transMatrices[[x]]))
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
mergedTM <- merge(meltTM, ppi, by=c("Var1","Var2"), all.x=T)
mergedTM[is.na(mergedTM)] <- 0
mergedTM <- mergedTM[as.character(mergedTM[,1])!=as.character(mergedTM[,2]),]
methodPred  <- prediction(mergedTM[,3], mergedTM[,4])
roc.methodPred  <- performance(methodPred, measure = c("tpr","auc"), x.measure = "fpr")
auc.methodPred  <- performance(methodPred, "auc")@y.values[[1]]
list("roc.methodPred"=roc.methodPred, "auc.methodPred"=auc.methodPred)
})
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
legend(.5,.2, c("Control to COPD", "Randomized Phenotype"), lty=c(1,1),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
c("AUC"=plotList[[1]]$auc.methodPred,"p-value="=p.value)
1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/ECLIPSE_combined_runs/activeImage.RData")
sum(controlsFilter)
sum(casesFilter)
dataset$ppi
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
ppi
ppi<-ppi[ppi[,1]!=ppi[,2]]
ppi<-ppi[as.character(ppi[,1])!=as.character(ppi[,2])]
ppi<-ppi[as.character(ppi[,1])!=as.character(ppi[,2]),]
ppi
dim(ppi)
dim(ppi)/2
223-184
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/ECLIPSE_combined_runs/activeImage.RData")
plotList <- lapply(1:401, function(x){
meltTM <- melt(abs(transMatrices[[x]]))
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
mergedTM <- merge(meltTM, ppi, by=c("Var1","Var2"), all.x=T)
mergedTM[is.na(mergedTM)] <- 0
mergedTM <- mergedTM[as.character(mergedTM[,1])!=as.character(mergedTM[,2]),]
methodPred  <- prediction(mergedTM[,3], mergedTM[,4])
roc.methodPred  <- performance(methodPred, measure = c("tpr","auc"), x.measure = "fpr")
auc.methodPred  <- performance(methodPred, "auc")@y.values[[1]]
list("roc.methodPred"=roc.methodPred, "auc.methodPred"=auc.methodPred)
})
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
legend(.5,.2, c("Control to COPD", "Randomized Phenotype"), lty=c(1,1),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
c("AUC"=plotList[[1]]$auc.methodPred,"p-value="=p.value)
library(reshape2)
?melt
plotList <- lapply(1:401, function(x){
meltTM <- melt(abs(transMatrices[[x]]))
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
mergedTM <- merge(meltTM, ppi, by=c("Var1","Var2"), all.x=T)
mergedTM[is.na(mergedTM)] <- 0
mergedTM <- mergedTM[as.character(mergedTM[,1])!=as.character(mergedTM[,2]),]
methodPred  <- prediction(mergedTM[,3], mergedTM[,4])
roc.methodPred  <- performance(methodPred, measure = c("tpr","auc"), x.measure = "fpr")
auc.methodPred  <- performance(methodPred, "auc")@y.values[[1]]
list("roc.methodPred"=roc.methodPred, "auc.methodPred"=auc.methodPred)
})
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
legend(.5,.2, c("Control to COPD", "Randomized Phenotype"), lty=c(1,1),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
c("AUC"=plotList[[1]]$auc.methodPred,"p-value="=p.value)
library(ROCR)
plotList <- lapply(1:401, function(x){
meltTM <- melt(abs(transMatrices[[x]]))
colnames(dataset$ppi) <- c("Var1","Var2","ppi")
ppi <- rbind(dataset$ppi, dataset$ppi[,c(2,1,3)])
mergedTM <- merge(meltTM, ppi, by=c("Var1","Var2"), all.x=T)
mergedTM[is.na(mergedTM)] <- 0
mergedTM <- mergedTM[as.character(mergedTM[,1])!=as.character(mergedTM[,2]),]
methodPred  <- prediction(mergedTM[,3], mergedTM[,4])
roc.methodPred  <- performance(methodPred, measure = c("tpr","auc"), x.measure = "fpr")
auc.methodPred  <- performance(methodPred, "auc")@y.values[[1]]
list("roc.methodPred"=roc.methodPred, "auc.methodPred"=auc.methodPred)
})
plot(plotList[[1]][["roc.methodPred"]], main="PPI Prediction", col = "red", lwd=3)
mapply(function(x,index){
lines(plotList[[x]][["roc.methodPred"]]@x.values[[1]], plotList[[x]][["roc.methodPred"]]@y.values[[1]], col = "blue", lwd=.5)
}, 2:length(plotList), 2:length(plotList))
lines(plotList[[1]][["roc.methodPred"]]@x.values[[1]], plotList[[1]][["roc.methodPred"]]@y.values[[1]], col = "red", lwd=3)
p.value <- 1-pnorm(scale(unlist(lapply(plotList, function(x){x$auc.methodPred})))[1])
legend(.5,.2, c("Control to COPD", "Randomized Phenotype"), lty=c(1,1),lwd=c(2,2),col=c("red", "blue"),title="Area under ROC curve")
c("AUC"=plotList[[1]]$auc.methodPred,"p-value="=p.value)
library(ggplot2)
library(gridExtra)
library(ggExtra)
library(gtable)
library(VennDiagram)
analysisNames <- c("ECLIPSE_combined_runs","COPDGene_combined_runs", "LGRC_combined_runs","LTCOPD_combined_runs")
displayNames <- c("ECLIPSE","COPDGene","LGRC","LTCOPD")
baseDir <- "~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/"
outputDir <- './'
getwd()
filenames <- sapply(analysisNames, function(aname){
dir(paste0(baseDir,aname), full.names = T, recursive = TRUE, all.files = TRUE, pattern="resultTable*")
})
resultTables <- lapply(filenames, read.csv)
names(resultTables) <- analysisNames
resultTables <- lapply(resultTables, function(x){
x$rankSig <- rank(x$dTFI.normalized.scores)
x <- x[order(-x$Magnitude),]
x$rankMag <- 1:nrow(x)
x$limma <- exp(-(x$limma))
x$negLogPValues <- -log(x$dTFI.normalized.scores)
colnames(x) <- paste(analysisNames[parent.frame()$i], colnames(x), sep="_")
x
})
resultTables
dim(resultTables)
class(resultTables)
length(resultTables)
merged.data.frame = Reduce(function(...) merge(..., by=1,all=T), resultTables)
merged.data.frame <- merged.data.frame[order(merged.data.frame[,2]),]
dim(merged.data.frame)
merged.data.frame
dim(merged.data.frame)
sum(is.na(merged.data.frame[,41]))
apply(merged.data.frame, 2, function(x){sum(is.na(x))})
library(bereR)
library(pandaR)
library(bptools)
library(reshape2)
library(penalized)
library(Biobase)
library(org.Hs.eg.db)
library(foreach)
library(doParallel)
library(limma)
library(igraph)
library(ggrepel)
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/ECLIPSE_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "ECLIPSE"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
1
supDTFIvsEXPdf <- cbind(plotDF, "ECLIPSE")
supDTFIvsEXPdf
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/COPDGene_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "COPDGene"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
1
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, "COPDGene"))
supDTFIvsEXPdf
colnames(supDTFIvsEXPdf)
colnames(supDTFIvsEXPdf)[7] <- "study"
colnames(supDTFIvsEXPdf)
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="COPDGene"))
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/LGRC_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "LGRC"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="LGRC"))
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/LTCOPD_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "LTCOPD"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="LTCOPD"))
1
dTFI_LIMMA_gg <- ggplot(data=plotDF, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients ",analysisCode,")")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=25,hjust=.5), axis.text=element_text(size=18), axis.title=element_text(size=22),
legend.text=element_text(size=30), legend.title=element_text(size=30), legend.key.size=unit(.7,"in"))
dTFI_LIMMA_gg
dTFI_LIMMA_gg <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients ",analysisCode,")")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=25,hjust=.5), axis.text=element_text(size=18), axis.title=element_text(size=22),
legend.text=element_text(size=30), legend.title=element_text(size=30), legend.key.size=unit(.7,"in"))
dTFI_LIMMA_gg
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients ",analysisCode,")")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=25,hjust=.5), axis.text=element_text(size=18), axis.title=element_text(size=22),
legend.text=element_text(size=30), legend.title=element_text(size=30), legend.key.size=unit(.7,"in"))
cairo_pdf(file.path(outputDir,paste('dTFI vs LIMMA ',analysisCode,'.pdf', sep="")), width=12, height=12)
print(dTFI_LIMMA_all)
dev.off()
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=12, height=12)
print(dTFI_LIMMA_all)
dev.off()
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients ",analysisCode,")")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=25,hjust=.5), axis.text=element_text(size=18), axis.title=element_text(size=40),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=30), legend.key.size=unit(.7,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=25,hjust=.5), axis.text=element_text(size=18), axis.title=element_text(size=40),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=60), legend.key.size=unit(.7,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=36), axis.title=element_text(size=40),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=30), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
supDTFIvsEXPdf
labels
rm(labels)
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40), legend.key.size=unit(1,"in"))
class(plotDF)
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=plotDF[plotDF$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
plotDF$labels
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=2), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(0.5, 'lines') +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(5, 'lines') +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,point.padding = unit(5, 'lines') +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(0.5, 'lines')) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(5, 'lines')) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(1, 'lines')) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
# Figure 2a-c -------------------------------------------------------------
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/ECLIPSE_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "ECLIPSE"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- cbind(plotDF, study="ECLIPSE")
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/COPDGene_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "COPDGene"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="COPDGene"))
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/LGRC_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "LGRC"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="LGRC"))
load("~/gd/Harvard/Research/TM_outputs/JASPAR2014/BERE/LTCOPD_combined_runs/activeImage.RData")
outputDir <- "~/gd/Harvard/Research/R_workspace/TM_manuscript/figures/"
analysisCode <- "LTCOPD"
source("~/gd/Harvard/Research/R_workspace/process_TM.R")
supDTFIvsEXPdf <- rbind(supDTFIvsEXPdf,cbind(plotDF, study="LTCOPD"))
dTFI_LIMMA_all <- ggplot(data=supDTFIvsEXPdf, aes(x=limmanegLogPValues, y=negLogZPValues)) + facet_wrap( ~ study, ncol=2) +
geom_point(aes(col=logfoldchangeTF), size=7, alpha=.8) +
geom_point(shape = 1,size = 7,colour = "black") +
geom_text_repel(data=supDTFIvsEXPdf[supDTFIvsEXPdf$labels!="",], aes(limmanegLogPValues, negLogZPValues, label=labels), size = 10,box.padding = unit(1, 'lines')) +
ylab("Differential TF Involvement, -log(p-value)") + xlab("Differential Expression,  LIMMA -log(p-value)") +
labs(title=paste0("Differential Involvement vs Differential Expression \n(Smoker Controls to COPD Patients )")) +
scale_colour_gradient2(limits=c(-.02,.02), oob = scales::squish, name="log(FC)", low = "blue", high = "yellow", mid="white") +
theme_classic() +
theme(plot.title = element_text(size=60,hjust=.5), axis.text=element_text(size=25), axis.title=element_text(size=50),
strip.text.x = element_text(size=40),
legend.text=element_text(size=30), legend.title=element_text(size=40, vjust=0), legend.key.size=unit(1,"in"))
cairo_pdf(file.path(outputDir,paste('dTFIvsLIMMAall.pdf', sep="")), width=24, height=24)
print(dTFI_LIMMA_all)
dev.off()
1
