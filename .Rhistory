nVariants <- 100000
germline <- rbinom(nVariants,1,.01)
errorRate <- .0001
errorsPerSample <- errorRate*nVariants
clusterALoci <- sample(nVariants,10)
clusterBLoci <- sample(nVariants,10)
clusterCLoci <- sample(nVariants,10)
clusterDLoci <- sample(nVariants,10)
clusterELoci <- sample(nVariants,10)
clusterFLoci <- sample(nVariants,10)
clusterGLoci <- sample(nVariants,10)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(data))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
nVariants <- 100000
germline <- rbinom(nVariants,1,.01)
errorRate <- .0001
errorsPerSample <- 0#errorRate*nVariants
clusterALoci <- sample(nVariants,10)
clusterBLoci <- sample(nVariants,10)
clusterCLoci <- sample(nVariants,10)
clusterDLoci <- sample(nVariants,10)
clusterELoci <- sample(nVariants,10)
clusterFLoci <- sample(nVariants,10)
clusterGLoci <- sample(nVariants,10)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
nVariants <- 100000
germline <- rbinom(nVariants,1,.01)
errorRate <- .0001
errorsPerSample <- 5#errorRate*nVariants
clusterALoci <- sample(nVariants,10)
clusterBLoci <- sample(nVariants,10)
clusterCLoci <- sample(nVariants,10)
clusterDLoci <- sample(nVariants,10)
clusterELoci <- sample(nVariants,10)
clusterFLoci <- sample(nVariants,10)
clusterGLoci <- sample(nVariants,10)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
sum(germline!=clusterA)
sum(dataObs[,1]!=dataObs[,2])
sum(dataObs[,1]!=dataObs[,3])
sum(dataObs[,1]!=dataObs[,4])
sum(dataObs[,1]!=dataObs[,5])
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
nVariants <- 100000
germline <- rbinom(nVariants,1,.01)
errorRate <- .0001
errorsPerSample <- 5#errorRate*nVariants
clusterALoci <- sample(nVariants,10)
clusterBLoci <- sample(nVariants,10)
clusterCLoci <- sample(nVariants,10)
clusterDLoci <- sample(nVariants,10)
clusterELoci <- sample(nVariants,10)
clusterFLoci <- sample(nVariants,10)
clusterGLoci <- sample(nVariants,10)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
nVariants <- 100000
germline <- rbinom(nVariants,1,.01)
errorRate <- .0001
errorsPerSample <- 5#errorRate*nVariants
clusterALoci <- sample(nVariants,10)
clusterBLoci <- sample(nVariants,10)
clusterCLoci <- sample(nVariants,10)
clusterDLoci <- sample(nVariants,10)
clusterELoci <- sample(nVariants,10)
clusterFLoci <- sample(nVariants,10)
clusterGLoci <- sample(nVariants,10)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
sum(dataObs[,1]!=dataObs[,5])
sum(dataObs[,1]!=dataObs[,4])
sum(dataObs[,1]!=dataObs[,3])
cor(dataObs)
errorRate*nVariants
errorsPerSample <- errorRate*nVariants
errorsPerSample
somatPerSample <- somaticMutRate*nVariants
somaticMutRate <- .0001
errorsPerSample <- errorRate*nVariants
somatPerSample <- somaticMutRate*nVariants
somatPerSample
nVariants
nVariants <- 1000000
nVariants
germline <- rbinom(nVariants,1,.01)
errorRate <- .00001
somaticMutRate <- .0001
errorsPerSample <- errorRate*nVariants
somatPerSample <- somaticMutRate*nVariants
somatPerSample
clusterALoci <- sample(nVariants,somatPerSample)
clusterBLoci <- sample(nVariants,somatPerSample)
clusterCLoci <- sample(nVariants,somatPerSample)
clusterDLoci <- sample(nVariants,somatPerSample)
clusterELoci <- sample(nVariants,somatPerSample)
clusterFLoci <- sample(nVariants,somatPerSample)
clusterGLoci <- sample(nVariants,somatPerSample)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
somatPerSample
errorsPerSample
head(dataObs)
errorRate
write.table(dataObs,file="./simulatedPhylogeneticData.txt" row.names = F, sep="")
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="")
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
system('tar -czvf ./simulatedPhylogeneticData.txt')
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
rownames(dataObs)
nVariants <- 10000000
germline <- rbinom(nVariants,1,.01)
errorRate <- .00001
somaticMutRate <- .0001
errorsPerSample <- errorRate*nVariants
somatPerSample <- somaticMutRate*nVariants
clusterALoci <- sample(nVariants,somatPerSample)
clusterBLoci <- sample(nVariants,somatPerSample)
clusterCLoci <- sample(nVariants,somatPerSample)
clusterDLoci <- sample(nVariants,somatPerSample)
clusterELoci <- sample(nVariants,somatPerSample)
clusterFLoci <- sample(nVariants,somatPerSample)
clusterGLoci <- sample(nVariants,somatPerSample)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
# write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
# system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
dim(dataObs)
getwd()
nVariants <- 10000000
germline <- rbinom(nVariants,1,.01)
errorRate <- .00001
somaticMutRate <- .0001
errorsPerSample <- errorRate*nVariants
somatPerSample <- somaticMutRate*nVariants
clusterALoci <- sample(nVariants,somatPerSample)
clusterBLoci <- sample(nVariants,somatPerSample)
clusterCLoci <- sample(nVariants,somatPerSample)
clusterDLoci <- sample(nVariants,somatPerSample)
clusterELoci <- sample(nVariants,somatPerSample)
clusterFLoci <- sample(nVariants,somatPerSample)
clusterGLoci <- sample(nVariants,somatPerSample)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
errorsPerSample
somatPerSample
1/errorRate
nVariants <- 10000000
germline <- rbinom(nVariants,1,.01)
errorRate <- .00002
somaticMutRate <- .00008
errorsPerSample <- errorRate*nVariants
somatPerSample <- somaticMutRate*nVariants
clusterALoci <- sample(nVariants, somatPerSample)
clusterBLoci <- sample(nVariants, somatPerSample)
clusterCLoci <- sample(nVariants, somatPerSample)
clusterDLoci <- sample(nVariants, somatPerSample)
clusterELoci <- sample(nVariants, somatPerSample)
clusterFLoci <- sample(nVariants, somatPerSample)
clusterGLoci <- sample(nVariants, somatPerSample)
clusterA <- germline
clusterA[clusterALoci] <- 1-clusterA[clusterALoci]
clusterB <- clusterA
clusterB[clusterBLoci] <- 1-clusterB[clusterBLoci]
clusterC <- clusterA
clusterC[clusterCLoci] <- 1-clusterC[clusterCLoci]
clusterD <- clusterB
clusterD[clusterDLoci] <- 1-clusterD[clusterDLoci]
clusterE <- clusterB
clusterE[clusterELoci] <- 1-clusterE[clusterELoci]
clusterF <- clusterC
clusterF[clusterFLoci] <- 1-clusterF[clusterFLoci]
clusterG <- clusterF
clusterG[clusterGLoci] <- 1-clusterG[clusterGLoci]
data <- cbind(germline,clusterA,clusterB,clusterC,clusterD,clusterE,clusterF,clusterG)
dataObs <- apply(data,2, function(x){
errors <- sample(length(x),errorsPerSample)
x[errors] <- 1-x[errors]
x
})
rownames(dataObs) <- 1:nVariants
# write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
# system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
dm <- dist(t(dataObs))
plot(hclust(dm))
library(igraph)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
1
plot(g, layout=layout_with_kk)
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.1] <- 1
adj[adj<.1] <- 0
adj
adj <- cor2pcor(cor(dataObs))
diag(adj) <- 0
round(adj,3)
adj[adj>.2] <- 1
adj[adj<.2] <- 0
colnames(adj) <- c("Germline",LETTERS[1:7])
rownames(adj) <- c("Germline",LETTERS[1:7])
g <- graph.adjacency(adj, mode="undirected", weighted=T)
plot(g, layout=layout_with_kk)
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = F, sep="\t")
system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
head(dataObs)
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = T, sep="\t")
write.table(dataObs,file="./simulatedPhylogeneticData.txt", row.names = T, sep="\t",quote = F)
system('tar -czvf ./simulatedPhylogeneticData.txt.gz ./simulatedPhylogeneticData.txt')
